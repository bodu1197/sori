# 🎵 MusicGram 아키텍처 개요

> **YouTube Music 기반 음악 플레이리스트 소셜 플랫폼**

---

## 📊 시스템 아키텍처

```
                        🌍 전 세계 사용자
                              │
                              ▼
                    ┌─────────────────┐
                    │   Cloudflare    │  ← DDoS 방어 + CDN
                    │    (무료)       │
                    └────────┬────────┘
                             │
              ┌──────────────┴──────────────┐
              ▼                              ▼
    ┌─────────────────┐            ┌─────────────────┐
    │     Vercel      │            │     Fly.io      │
    │  (프론트엔드)    │            │   (백엔드 API)   │
    │   자동 확장 ✅   │            │   자동 확장 ✅   │
    └─────────────────┘            └────────┬────────┘
                                            │
                            ┌───────────────┼───────────────┐
                            ▼               ▼               ▼
                    ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
                    │   Upstash   │ │  Supabase   │ │  Supabase   │
                    │   Redis     │ │  Database   │ │   Storage   │
                    │   (캐시)    │ │   (DB)      │ │  (이미지)   │
                    └─────────────┘ └─────────────┘ └─────────────┘
```

---

## 🏗️ 각 서비스 역할

### 피자 가게 비유로 이해하기

| 피자 가게          | MusicGram    | 담당 서비스        | 역할                      |
| ------------------ | ------------ | ------------------ | ------------------------- |
| 🍽️ **손님 테이블** | 예쁜 앱 화면 | **Vercel**         | 사용자가 보는 화면        |
| 👩‍🍳 **주방**        | 데이터 처리  | **Fly.io/Railway** | 음악 검색, API 로직       |
| 🧊 **냉장고**      | 데이터 저장  | **Supabase**       | 사용자, 플레이리스트 저장 |
| 📋 **메모장**      | 임시 저장    | **Redis**          | 빠른 캐시                 |

---

## 🔧 기술 스택 상세

| 구분             | 기술                        | 용도                 |
| ---------------- | --------------------------- | -------------------- |
| **프론트엔드**   | React + Vite + Tailwind CSS | UI 구현              |
| **백엔드**       | FastAPI (Python 3.10+)      | API 서버             |
| **음악 API**     | ytmusicapi                  | YouTube Music 데이터 |
| **데이터베이스** | Supabase (PostgreSQL)       | 데이터 저장          |
| **인증**         | Supabase Auth               | 로그인/회원가입      |
| **스토리지**     | Supabase Storage            | 이미지 저장          |
| **캐시**         | Upstash Redis               | 빠른 응답            |
| **CDN**          | Cloudflare                  | 글로벌 콘텐츠 배포   |

---

## 📁 프로젝트 폴더 구조

```
musicgram/
├── backend/
│   ├── main.py                 # FastAPI 앱 진입점
│   ├── routers/
│   │   ├── auth.py            # 인증 API
│   │   ├── posts.py           # 플레이리스트 CRUD
│   │   ├── users.py           # 사용자 프로필
│   │   ├── music.py           # 음악 검색
│   │   └── social.py          # 좋아요, 댓글, 팔로우
│   ├── services/
│   │   ├── ytmusic.py         # YouTube Music 서비스
│   │   ├── supabase.py        # Supabase 클라이언트
│   │   └── cache.py           # Redis 캐시 서비스
│   ├── requirements.txt
│   └── Dockerfile
│
├── frontend/
│   ├── src/
│   │   ├── components/
│   │   │   ├── Feed/          # 피드 컴포넌트
│   │   │   ├── Profile/       # 프로필 컴포넌트
│   │   │   ├── Music/         # 음악 관련 컴포넌트
│   │   │   └── Social/        # 소셜 기능 컴포넌트
│   │   ├── pages/             # 페이지 컴포넌트
│   │   ├── lib/               # 유틸리티
│   │   ├── hooks/             # 커스텀 훅
│   │   └── store/             # 상태 관리
│   ├── package.json
│   └── vite.config.js
│
├── docs/                       # 문서
│   ├── 01_아키텍처_개요.md
│   ├── 02_ytmusicapi_가이드.md
│   ├── 03_확장성_설계.md
│   └── 04_국가별_콘텐츠.md
│
└── README.md
```

---

## 🔗 서비스 연결 흐름

```
1. 사용자가 "아이유" 검색
         │
         ▼
2. Vercel (프론트엔드)
   → fetch('/api/music/search?q=아이유')
         │
         ▼
3. Fly.io (백엔드)
   → Redis 캐시 확인
   → 없으면 ytmusicapi.search('아이유')
   → 결과 캐시 저장
         │
         ▼
4. 프론트엔드로 결과 반환
         │
         ▼
5. 사용자가 결과 확인! 🎵
```

---

## 📅 다음 단계

1. Supabase 프로젝트 생성
2. 데이터베이스 테이블 설계
3. 백엔드 기본 구조 구축
4. 프론트엔드 기본 구조 구축
5. 음악 검색 기능 구현
